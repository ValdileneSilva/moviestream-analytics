{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2025-05-12T22:35:50.987085Z", "invocation_id": "1c593713-9481-4216-96bf-c2b59564988a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:46.662498Z", "completed_at": "2025-05-12T22:35:46.688637Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:46.691246Z", "completed_at": "2025-05-12T22:35:46.979007Z"}], "thread_id": "Thread-1", "execution_time": 0.32579660415649414, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.moviestream_analytics.stg_customer", "compiled": true, "compiled_code": "SELECT\n    customer_id,\n    store_id,\n    first_name,\n    last_name,\n    email,\n    address_id,\n    activebool AS is_active,\n    create_date,\n    last_update\nFROM \"landing_db\".\"public\".\"customer\"", "relation_name": "\"landing_db\".\"public\".\"stg_customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:47.002456Z", "completed_at": "2025-05-12T22:35:47.032322Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:47.039287Z", "completed_at": "2025-05-12T22:35:47.234163Z"}], "thread_id": "Thread-1", "execution_time": 0.2411632537841797, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.moviestream_analytics.stg_film", "compiled": true, "compiled_code": "SELECT\n    film_id,\n    title,\n    description,\n    release_year,\n    language_id,\n    rental_duration,\n    rental_rate,\n    length,\n    replacement_cost,\n    rating,\n    last_update\nFROM \"landing_db\".\"public\".\"film\"", "relation_name": "\"landing_db\".\"public\".\"stg_film\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:47.259648Z", "completed_at": "2025-05-12T22:35:47.279019Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:47.283513Z", "completed_at": "2025-05-12T22:35:47.489020Z"}], "thread_id": "Thread-1", "execution_time": 0.23749804496765137, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.moviestream_analytics.stg_inventory", "compiled": true, "compiled_code": "SELECT\n    inventory_id,\n    film_id,\n    store_id,\n    last_update\nFROM \"landing_db\".\"public\".\"inventory\"", "relation_name": "\"landing_db\".\"public\".\"stg_inventory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:47.503303Z", "completed_at": "2025-05-12T22:35:47.521695Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:47.524394Z", "completed_at": "2025-05-12T22:35:47.803860Z"}], "thread_id": "Thread-1", "execution_time": 0.30730342864990234, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.moviestream_analytics.stg_payment", "compiled": true, "compiled_code": "SELECT\n    payment_id,\n    customer_id,\n    staff_id,\n    rental_id,\n    amount,\n    payment_date\nFROM \"landing_db\".\"public\".\"payment\"", "relation_name": "\"landing_db\".\"public\".\"stg_payment\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:47.821271Z", "completed_at": "2025-05-12T22:35:47.840846Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:47.843650Z", "completed_at": "2025-05-12T22:35:48.086513Z"}], "thread_id": "Thread-1", "execution_time": 0.28133344650268555, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.moviestream_analytics.stg_rental", "compiled": true, "compiled_code": "SELECT\n    rental_id,\n    rental_date,\n    inventory_id,\n    customer_id,\n    return_date,\n    staff_id,\n    last_update\nFROM \"landing_db\".\"public\".\"rental\"", "relation_name": "\"landing_db\".\"public\".\"stg_rental\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:48.145315Z", "completed_at": "2025-05-12T22:35:48.234987Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:48.239649Z", "completed_at": "2025-05-12T22:35:48.455702Z"}], "thread_id": "Thread-1", "execution_time": 0.33079075813293457, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.moviestream_analytics.stg_store", "compiled": true, "compiled_code": "SELECT\n    store_id,\n    manager_staff_id,\n    address_id,\n    last_update\nFROM \"landing_db\".\"public\".\"store\"", "relation_name": "\"landing_db\".\"public\".\"stg_store\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:48.484388Z", "completed_at": "2025-05-12T22:35:48.509016Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:48.511809Z", "completed_at": "2025-05-12T22:35:49.311178Z"}], "thread_id": "Thread-1", "execution_time": 0.8370447158813477, "adapter_response": {"_message": "SELECT 599", "code": "SELECT", "rows_affected": 599}, "message": "SELECT 599", "failures": null, "unique_id": "model.moviestream_analytics.mart_customer_lifetime_value", "compiled": true, "compiled_code": "SELECT\n    c.customer_id,\n    MIN(r.rental_date) AS first_rental_date,\n    MAX(r.rental_date) AS last_rental_date,\n    COUNT(r.rental_id) AS total_rentals,\n    SUM(p.amount) AS total_spent,\n    DATE_PART('day', CURRENT_DATE - MIN(r.rental_date)) AS days_since_first_rental\nFROM \"landing_db\".\"public\".\"stg_customer\" c\nJOIN \"landing_db\".\"public\".\"stg_rental\" r ON c.customer_id = r.customer_id\nJOIN \"landing_db\".\"public\".\"stg_payment\" p ON r.rental_id = p.rental_id\nGROUP BY c.customer_id", "relation_name": "\"landing_db\".\"public\".\"mart_customer_lifetime_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:49.327978Z", "completed_at": "2025-05-12T22:35:49.350346Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:49.354082Z", "completed_at": "2025-05-12T22:35:49.796243Z"}], "thread_id": "Thread-1", "execution_time": 0.47485899925231934, "adapter_response": {"_message": "SELECT 3670", "code": "SELECT", "rows_affected": 3670}, "message": "SELECT 3670", "failures": null, "unique_id": "model.moviestream_analytics.mart_film_popularity", "compiled": true, "compiled_code": "SELECT\n    f.film_id,\n    f.title,\n    DATE_PART('year', r.rental_date) AS rental_year,\n    DATE_PART('month', r.rental_date) AS rental_month,\n    COUNT(r.rental_id) AS rental_count\nFROM \"landing_db\".\"public\".\"stg_film\" f\nJOIN \"landing_db\".\"public\".\"stg_inventory\" i ON f.film_id = i.film_id\nJOIN \"landing_db\".\"public\".\"stg_rental\" r ON i.inventory_id = r.inventory_id\nGROUP BY f.film_id, f.title, rental_year, rental_month", "relation_name": "\"landing_db\".\"public\".\"mart_film_popularity\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T22:35:49.811610Z", "completed_at": "2025-05-12T22:35:49.837142Z"}, {"name": "execute", "started_at": "2025-05-12T22:35:49.840197Z", "completed_at": "2025-05-12T22:35:50.900639Z"}], "thread_id": "Thread-1", "execution_time": 1.1033599376678467, "adapter_response": {"_message": "SELECT 2", "code": "SELECT", "rows_affected": 2}, "message": "SELECT 2", "failures": null, "unique_id": "model.moviestream_analytics.mart_store_performance", "compiled": true, "compiled_code": "SELECT\n    s.store_id,\n    COUNT(DISTINCT r.rental_id) AS total_rentals,\n    SUM(p.amount) AS total_revenue,\n    COUNT(DISTINCT c.customer_id) AS num_customers\nFROM \"landing_db\".\"public\".\"stg_store\" s\nJOIN \"landing_db\".\"public\".\"stg_inventory\" i ON s.store_id = i.store_id\nJOIN \"landing_db\".\"public\".\"stg_rental\" r ON i.inventory_id = r.inventory_id\nJOIN \"landing_db\".\"public\".\"stg_payment\" p ON r.rental_id = p.rental_id\nJOIN \"landing_db\".\"public\".\"stg_customer\" c ON c.customer_id = r.customer_id\nGROUP BY s.store_id", "relation_name": "\"landing_db\".\"public\".\"mart_store_performance\""}], "elapsed_time": 4.553602695465088, "args": {"populate_cache": true, "send_anonymous_usage_stats": true, "strict_mode": false, "defer": false, "log_path": "/opt/airflow/dags/moviestream_analytics/logs", "profiles_dir": "./.dbt", "project_dir": "/opt/airflow/dags/moviestream_analytics", "print": true, "vars": {}, "favor_state": false, "quiet": false, "log_level": "info", "use_colors": true, "enable_legacy_logger": false, "write_json": true, "indirect_selection": "eager", "introspect": true, "show_resource_report": false, "invocation_command": "dbt run --profiles-dir ./.dbt", "static_parser": true, "partial_parse": true, "exclude": [], "log_format_file": "debug", "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "which": "run", "select": [], "log_file_max_bytes": 10485760, "macro_debugging": false, "version_check": true, "log_format": "default", "printer_width": 80, "log_level_file": "debug", "cache_selected_only": false}}